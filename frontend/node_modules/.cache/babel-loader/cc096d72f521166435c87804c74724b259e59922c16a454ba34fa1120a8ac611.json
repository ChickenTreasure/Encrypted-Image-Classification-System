{"ast":null,"code":"export default {\n  name: \"ImageCard\",\n  data() {\n    return {\n      url: process.env.VUE_APP_BASE_API + \"/image?id=\",\n      colors: [\"#a3c6ea\", \"#70a8c4\", \"#559bcb\"],\n      labelColor: [\"#77C9D4\", \"#57BC90\", \"#015249\"],\n      imageSource: \"\",\n      isMouseOn: false,\n      tags: [],\n      isCollected: false,\n      dialogVisible: false,\n      isCollectedLoading: false\n    };\n  },\n  computed: {\n    showTags() {\n      if (this.tags.length !== 0) {\n        return this.tags.slice(0, 3);\n      } else {\n        return [\"none\"];\n      }\n    },\n    isTagDisallowed() {\n      if (!this.hideTags) {\n        return true;\n      }\n      for (let i = 0; i < this.tags.length; ++i) {\n        if (this.disallowedTags.indexOf(this.tags[i]) !== -1) {\n          return false;\n        }\n      }\n      return true;\n    }\n  },\n  props: {\n    imageId: String,\n    disallowedTags: Array,\n    hideTags: Boolean\n  },\n  created() {\n    // 获取图片详细信息\n    this.$axios({\n      method: \"get\",\n      url: \"/info\",\n      params: {\n        id: this.imageId\n      }\n    }).then(response => {\n      this.isCollected = response.data.isCollected;\n      this.tags = response.data.tags;\n    }).catch(() => {});\n  },\n  methods: {\n    collectImage() {\n      this.isCollectedLoading = true;\n      this.$axios({\n        method: \"post\",\n        url: \"/collect\",\n        data: {\n          id: this.imageId\n        }\n      }).then(() => {\n        this.isCollected = !this.isCollected;\n        if (this.isCollected) {\n          this.$message({\n            message: \"收藏成功！\",\n            type: \"success\"\n          });\n        } else {\n          this.$message({\n            message: \"已取消收藏\",\n            type: \"success\"\n          });\n        }\n        this.isCollectedLoading = false;\n      }).catch(() => {\n        this.isCollectedLoading = false;\n      }).finally(() => {\n        this.$emit(\"changeCollect\");\n      });\n    },\n    viewImageDetail() {\n      this.dialogVisible = true;\n    }\n  }\n};","map":{"version":3,"names":["name","data","url","process","env","VUE_APP_BASE_API","colors","labelColor","imageSource","isMouseOn","tags","isCollected","dialogVisible","isCollectedLoading","computed","showTags","length","slice","isTagDisallowed","hideTags","i","disallowedTags","indexOf","props","imageId","String","Array","Boolean","created","$axios","method","params","id","then","response","catch","methods","collectImage","$message","message","type","finally","$emit","viewImageDetail"],"sources":["src/components/ImageCard.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div v-if=\"isTagDisallowed\" class=\"CardContainer\">\r\n      <div\r\n        class=\"CardType\"\r\n      >\r\n        <!---->\r\n        <el-image\r\n          fit=\"fill\"\r\n          style=\"\r\n            width: 100%;\r\n            height: 62%;\r\n            border-radius: 10px 10px 0 0;\r\n            box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px,\r\n              rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;\r\n          \"\r\n          :src= \"url + imageId\"\r\n        >\r\n        </el-image>\r\n        <el-row style=\"margin-top: 10px\">\r\n          <el-col :span=\"3\">\r\n            <!--收藏图片-->\r\n            <el-tooltip\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              :content=\"\r\n                isCollectedLoading\r\n                  ? '加载中...'\r\n                  : isCollected\r\n                  ? '取消收藏'\r\n                  : '收藏'\r\n              \"\r\n              placement=\"top-start\"\r\n            >\r\n              <div v-if=\"!isCollectedLoading\">\r\n                <em\r\n                  :class=\"isCollected ? 'el-icon-star-on' : 'el-icon-star-off'\"\r\n                  style=\"font-size: 20px\"\r\n                  @click=\"collectImage\"\r\n                ></em>\r\n              </div>\r\n              <div v-else>\r\n                <em class=\"el-icon-loading\" style=\"font-size: 20px\"></em>\r\n              </div>\r\n            </el-tooltip>\r\n          </el-col>\r\n          <el-col :span=\"3\">\r\n            <!--查看大图-->\r\n            <el-tooltip\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              content=\"查看大图\"\r\n              placement=\"top-start\"\r\n            >\r\n              <em\r\n                class=\"el-icon-zoom-in\"\r\n                style=\"font-size: 20px\"\r\n                @click=\"viewImageDetail\"\r\n              ></em>\r\n            </el-tooltip>\r\n          </el-col>\r\n          <el-col :span=\"18\">\r\n            <span> No. {{ imageId }} </span>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <div class=\"label-list\">\r\n          <el-tag\r\n            type=\"primary\"\r\n            v-for=\"(i, index) in showTags\"\r\n            :key=\"index\"\r\n            effect=\"dark\"\r\n            :color=\"labelColor[index]\"\r\n            :hit=\"true\"\r\n          >\r\n            {{ i }}\r\n          </el-tag>\r\n        </div>\r\n\r\n        <el-dialog :visible.sync=\"dialogVisible\" modal width=\"40%\">\r\n          <img\r\n            :src=\"url + imageId\"\r\n            alt=\"\"\r\n            style=\"width: 100%; height: 100%; object-fit: contain;\"\r\n          />\r\n        </el-dialog>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"ImageCard\",\r\n\r\n  data() {\r\n    return {\r\n      url:  process.env.VUE_APP_BASE_API + \"/image?id=\",\r\n      colors: [\"#a3c6ea\", \"#70a8c4\", \"#559bcb\"],\r\n      labelColor: [\"#77C9D4\", \"#57BC90\", \"#015249\"],\r\n      imageSource: \"\",\r\n      isMouseOn: false,\r\n      tags: [],\r\n      isCollected: false,\r\n      dialogVisible: false,\r\n      isCollectedLoading: false,\r\n    };\r\n  },\r\n\r\n  computed: {\r\n    showTags() {\r\n      if (this.tags.length !== 0) {\r\n        return this.tags.slice(0, 3);\r\n      } else {\r\n        return [\"none\"];\r\n      }\r\n    },\r\n    isTagDisallowed() {\r\n      if (!this.hideTags) {\r\n        return true;\r\n      }\r\n      for (let i = 0; i < this.tags.length; ++i) {\r\n        if (this.disallowedTags.indexOf(this.tags[i]) !== -1) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    },\r\n  },\r\n\r\n  props: {\r\n    imageId: String,\r\n    disallowedTags: Array,\r\n    hideTags: Boolean,\r\n  },\r\n\r\n  created() {\r\n    // 获取图片详细信息\r\n    this.$axios({\r\n      method: \"get\",\r\n      url: \"/info\",\r\n      params: {\r\n        id: this.imageId,\r\n      },\r\n    })\r\n      .then((response) => {\r\n        this.isCollected = response.data.isCollected;\r\n        this.tags = response.data.tags;\r\n      })\r\n      .catch(() => {});\r\n  },\r\n\r\n  methods: {\r\n    collectImage() {\r\n      this.isCollectedLoading = true;\r\n      this.$axios({\r\n        method: \"post\",\r\n        url: \"/collect\",\r\n        data: {\r\n          id: this.imageId,\r\n        },\r\n      })\r\n        .then(() => {\r\n          this.isCollected = !this.isCollected;\r\n          if (this.isCollected) {\r\n            this.$message({\r\n              message: \"收藏成功！\",\r\n              type: \"success\",\r\n            });\r\n          } else {\r\n            this.$message({\r\n              message: \"已取消收藏\",\r\n              type: \"success\",\r\n            })\r\n          }\r\n          this.isCollectedLoading = false;\r\n        })\r\n        .catch(() => {\r\n          this.isCollectedLoading = false;\r\n        })\r\n        .finally(() => {\r\n          this.$emit(\"changeCollect\");\r\n        });\r\n    },\r\n    viewImageDetail() {\r\n      this.dialogVisible = true;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.CardType {\r\n  width: 95%;\r\n  height: 95%;\r\n  margin: 5px auto 0;\r\n  border-radius: 10px !important;\r\n  box-shadow: rgba(0, 0, 0, 0.1) 0px 20px 25px -5px,\r\n    rgba(0, 0, 0, 0.04) 0px 10px 10px -5px !important;\r\n  background-color: rgba(229, 225, 225, 0.34);\r\n  cursor: pointer;\r\n  -webkit-transition: all 200ms ease-in;\r\n}\r\n</style>\r\n\r\n<style scoped>\r\n.el-divider--vertical {\r\n  height: 4em !important;\r\n  width: 2px !important;\r\n}\r\n\r\n.icon-love {\r\n  position: absolute;\r\n  left: 40%;\r\n  bottom: 40%;\r\n}\r\n\r\n/* 标签列表 */\r\n.label-list {\r\n  padding: 1px 1px;\r\n  margin: 1px 1px;\r\n}\r\n.el-tag {\r\n  float: left;\r\n  white-space: pre-line;\r\n  word-break: break-all;\r\n  margin-top: 5px;\r\n  margin-left: 5px;\r\n  max-height: 4vh;\r\n  color: white;\r\n}\r\n\r\n.CardContainer {\r\n  width: 270px;\r\n  height: 290px;\r\n  margin-bottom: 20px;\r\n  margin-left: 25px;\r\n}\r\n</style>\r\n"],"mappings":"AA4FA;EACAA,IAAA;EAEAC,KAAA;IACA;MACAC,GAAA,EAAAC,OAAA,CAAAC,GAAA,CAAAC,gBAAA;MACAC,MAAA;MACAC,UAAA;MACAC,WAAA;MACAC,SAAA;MACAC,IAAA;MACAC,WAAA;MACAC,aAAA;MACAC,kBAAA;IACA;EACA;EAEAC,QAAA;IACAC,SAAA;MACA,SAAAL,IAAA,CAAAM,MAAA;QACA,YAAAN,IAAA,CAAAO,KAAA;MACA;QACA;MACA;IACA;IACAC,gBAAA;MACA,UAAAC,QAAA;QACA;MACA;MACA,SAAAC,CAAA,MAAAA,CAAA,QAAAV,IAAA,CAAAM,MAAA,IAAAI,CAAA;QACA,SAAAC,cAAA,CAAAC,OAAA,MAAAZ,IAAA,CAAAU,CAAA;UACA;QACA;MACA;MACA;IACA;EACA;EAEAG,KAAA;IACAC,OAAA,EAAAC,MAAA;IACAJ,cAAA,EAAAK,KAAA;IACAP,QAAA,EAAAQ;EACA;EAEAC,QAAA;IACA;IACA,KAAAC,MAAA;MACAC,MAAA;MACA5B,GAAA;MACA6B,MAAA;QACAC,EAAA,OAAAR;MACA;IACA,GACAS,IAAA,CAAAC,QAAA;MACA,KAAAvB,WAAA,GAAAuB,QAAA,CAAAjC,IAAA,CAAAU,WAAA;MACA,KAAAD,IAAA,GAAAwB,QAAA,CAAAjC,IAAA,CAAAS,IAAA;IACA,GACAyB,KAAA;EACA;EAEAC,OAAA;IACAC,aAAA;MACA,KAAAxB,kBAAA;MACA,KAAAgB,MAAA;QACAC,MAAA;QACA5B,GAAA;QACAD,IAAA;UACA+B,EAAA,OAAAR;QACA;MACA,GACAS,IAAA;QACA,KAAAtB,WAAA,SAAAA,WAAA;QACA,SAAAA,WAAA;UACA,KAAA2B,QAAA;YACAC,OAAA;YACAC,IAAA;UACA;QACA;UACA,KAAAF,QAAA;YACAC,OAAA;YACAC,IAAA;UACA;QACA;QACA,KAAA3B,kBAAA;MACA,GACAsB,KAAA;QACA,KAAAtB,kBAAA;MACA,GACA4B,OAAA;QACA,KAAAC,KAAA;MACA;IACA;IACAC,gBAAA;MACA,KAAA/B,aAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}